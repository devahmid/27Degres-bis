<div class="container mx-auto px-4 py-8">
  <div class="mb-8">
    <h1 class="text-4xl font-bold text-dark mb-4">Forum d'Idées</h1>
    <p class="text-gray-600 text-lg">Proposez vos idées, votez et commentez pour faire vivre l'association !</p>
  </div>

  <!-- Filtres -->
  <div class="bg-white rounded-lg shadow-md p-6 mb-6">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
      <div>
        <label class="block text-dark font-medium mb-2">Catégorie</label>
        <select
          [(ngModel)]="selectedCategory"
          (ngModelChange)="onFilterChange()"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white text-gray-700">
          <option *ngFor="let cat of categories" [value]="cat.value">
            {{ cat.label }}
          </option>
        </select>
      </div>

      <div>
        <label class="block text-dark font-medium mb-2">Statut</label>
        <select
          [(ngModel)]="selectedStatus"
          (ngModelChange)="onFilterChange()"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white text-gray-700">
          <option *ngFor="let status of statuses" [value]="status.value">
            {{ status.label }}
          </option>
        </select>
      </div>

      <div>
        <label class="block text-dark font-medium mb-2">Trier par</label>
        <select
          [(ngModel)]="selectedSort"
          (ngModelChange)="onFilterChange()"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all bg-white text-gray-700">
          <option *ngFor="let sort of sortOptions" [value]="sort.value">
            {{ sort.label }}
          </option>
        </select>
      </div>
    </div>

    <div class="flex justify-end pt-4 border-t border-gray-200">
      <button 
        *ngIf="authService.isLoggedIn()"
        mat-raised-button 
        color="primary" 
        [routerLink]="['/ideas', 'new']"
        class="flex items-center gap-2">
        <mat-icon>add</mat-icon>
        <span>Proposer une idée</span>
      </button>
      <a 
        *ngIf="!authService.isLoggedIn()"
        mat-raised-button 
        color="primary" 
        routerLink="/auth/login"
        class="flex items-center gap-2">
        <mat-icon>login</mat-icon>
        <span>Connectez-vous pour proposer une idée</span>
      </a>
    </div>
  </div>

  <!-- Liste des idées -->
  <div *ngIf="loading" class="text-center py-12">
    <mat-icon class="text-4xl text-gray-400 animate-spin">refresh</mat-icon>
    <p class="mt-4 text-gray-600">Chargement des idées...</p>
  </div>

  <div *ngIf="!loading && ideas.length === 0" class="text-center py-12">
    <mat-icon class="text-4xl text-gray-400">lightbulb_outline</mat-icon>
    <p class="mt-4 text-gray-600 text-lg">Aucune idée pour le moment</p>
    <p class="text-sm text-gray-500 mt-2">Soyez le premier à proposer une idée !</p>
  </div>

  <div *ngIf="!loading && ideas.length > 0" class="grid grid-cols-1 gap-6">
    <mat-card *ngFor="let idea of ideas" class="hover:shadow-xl transition-all duration-300 cursor-pointer border border-gray-200" [routerLink]="['/ideas', idea.id]">
      <mat-card-header class="bg-gradient-to-r from-primary to-accent text-white">
        <div class="flex-grow w-full">
          <mat-card-title class="text-xl mb-2 line-clamp-2">{{ idea.title }}</mat-card-title>
          <mat-card-subtitle class="flex items-center gap-4 flex-wrap text-white/90">
            <span class="flex items-center gap-1 text-sm">
              <mat-icon class="text-sm">person</mat-icon>
              {{ idea.author.firstName }} {{ idea.author.lastName }}
            </span>
            <span class="flex items-center gap-1 text-sm">
              <mat-icon class="text-sm">schedule</mat-icon>
              {{ idea.createdAt | dateFormat }}
            </span>
          </mat-card-subtitle>
        </div>
      </mat-card-header>
      <mat-card-content class="p-6">
        <p class="text-gray-700 line-clamp-3 mb-4 leading-relaxed">{{ idea.description }}</p>
        <div class="flex items-center gap-2 flex-wrap mb-4">
          <span 
            class="px-3 py-1 rounded-full text-xs font-medium"
            [style.background-color]="getCategoryColor(idea.category)"
            [style.color]="getCategoryTextColor(idea.category)">
            {{ getCategoryLabel(idea.category) }}
          </span>
          <span 
            class="px-3 py-1 rounded-full text-xs font-medium"
            [style.background-color]="getStatusColor(idea.status)"
            [style.color]="getStatusTextColor(idea.status)">
            {{ getStatusLabel(idea.status) }}
          </span>
          <span *ngIf="idea.estimatedBudget" class="text-sm text-gray-600 flex items-center gap-1 px-3 py-1 bg-gray-100 rounded-full">
            <mat-icon class="text-sm">euro</mat-icon>
            {{ idea.estimatedBudget }}€
          </span>
        </div>
      </mat-card-content>
      <mat-card-actions class="flex items-center justify-between px-6 pb-6 pt-0 border-t border-gray-100">
        <div class="flex items-center gap-6">
          <span class="flex items-center gap-2 text-gray-600">
            <mat-icon class="text-lg" [class.text-primary]="idea.votes > 0">thumb_up</mat-icon>
            <span class="font-semibold">{{ idea.votes }}</span>
          </span>
          <span class="flex items-center gap-2 text-gray-600">
            <mat-icon class="text-lg" [class.text-primary]="idea.commentsCount > 0">comment</mat-icon>
            <span class="font-semibold">{{ idea.commentsCount }}</span>
          </span>
        </div>
        <button mat-button color="primary" class="flex items-center gap-1">
          <span>Voir les détails</span>
          <mat-icon class="text-sm">arrow_forward</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
