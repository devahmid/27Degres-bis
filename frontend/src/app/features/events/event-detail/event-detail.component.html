<div class="container mx-auto px-4 py-8" *ngIf="event$ | async as event">
  <mat-card>
    <img *ngIf="event.featuredImage" mat-card-image [src]="event.featuredImage" [alt]="event.title" class="max-h-96 object-cover">
    <mat-card-header>
      <mat-card-title class="text-3xl">{{ event.title }}</mat-card-title>
      <mat-card-subtitle>
        {{ event.startDate | dateFormat:'dd MMMM yyyy' }}
        <span *ngIf="event.endDate"> - {{ event.endDate | dateFormat:'dd MMMM yyyy' }}</span>
        <span *ngIf="event.location"> - {{ event.location }}</span>
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div [innerHTML]="event.description | formatContent" class="prose max-w-none article-content"></div>
    </mat-card-content>
    <mat-card-actions>
      <div *ngIf="authService.isLoggedIn(); else loginPrompt" class="w-full">
        <div *ngIf="checkingRegistration" class="text-center py-4">
          <mat-icon class="animate-spin">refresh</mat-icon>
          <span class="ml-2">Vérification de votre inscription...</span>
        </div>
        <div *ngIf="!checkingRegistration">
          <button 
            *ngIf="!isRegistered"
            mat-raised-button 
            color="primary" 
            (click)="registerForEvent(event.id)"
            class="w-full">
            <mat-icon>event_available</mat-icon>
            <span class="ml-2">S'inscrire à cet événement</span>
          </button>
          <div *ngIf="isRegistered" class="bg-green-50 border border-green-200 rounded-lg p-4">
            <div class="flex items-center gap-3 mb-3">
              <mat-icon class="text-green-600">check_circle</mat-icon>
              <div class="flex-grow">
                <p class="font-semibold text-green-800">Vous êtes inscrit à cet événement</p>
                <p class="text-sm text-green-600">Vous recevrez une confirmation par email</p>
              </div>
            </div>
            <button 
              mat-stroked-button 
              color="warn" 
              (click)="unregisterFromEvent(event.id)"
              class="w-full">
              <mat-icon>cancel</mat-icon>
              <span class="ml-2">Se désinscrire</span>
            </button>
          </div>
        </div>
      </div>
      <ng-template #loginPrompt>
        <div class="w-full bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
          <mat-icon class="text-blue-600 mb-2">info</mat-icon>
          <p class="text-blue-800 mb-3">Vous devez être connecté pour vous inscrire</p>
          <a mat-raised-button color="primary" routerLink="/auth/login" class="w-full">
            <mat-icon>login</mat-icon>
            <span class="ml-2">Se connecter</span>
          </a>
        </div>
      </ng-template>
    </mat-card-actions>
  </mat-card>
</div>









